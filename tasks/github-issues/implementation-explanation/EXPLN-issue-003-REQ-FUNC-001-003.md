# π“‹ issue-003-REQ-FUNC-001-003: SCON μ¨λ³΄λ”© μ‹μ¤ν…

λ² μ΄μ»¤λ¦¬ μΉ΄ν μ‚¬μ¥λ‹μ΄ SCON μ„λΉ„μ¤μ— κ°€μ…ν•κ³  λ§¤μ¥κ³Ό μ§μ›μ„ λ“±λ΅ν•λ” μ „μ²΄ ν”λ΅μ° κµ¬ν„

---

## π” 1. μΈμ¦ μ‹μ¤ν… (AuthService)

### νμ›κ°€μ… ν”λ΅μ°

```
μ‚¬μ¥λ‹μ΄ κ°€μ… λ²„νΌ ν΄λ¦­ β†’ μ΄λ©”μΌ μ¤‘λ³µ μ²΄ν¬ β†’ λΉ„λ°€λ²νΈ μ•”νΈν™” μ €μ¥ β†’ JWT ν† ν° λ°κΈ‰
```

**μ‰½κ² λ§ν•λ©΄:**

- μ‚¬μ¥λ‹μ΄ μ΄λ©”μΌ, λΉ„λ°€λ²νΈ, μ΄λ¦„, μ „ν™”λ²νΈλ¥Ό μ…λ ¥ν•λ©΄
- λ¨Όμ € μ΄λ―Έ κ°€μ…λ μ΄λ©”μΌμΈμ§€ ν™•μΈν•©λ‹λ‹¤
- λΉ„λ°€λ²νΈλ” BCryptλΌλ” λ°©μ‹μΌλ΅ μ•”νΈν™”ν•΄μ„ μ €μ¥ν•©λ‹λ‹¤ (μ›λ³Έ λΉ„λ°€λ²νΈλ¥Ό μ•„λ¬΄λ„ λ³Ό μ μ—†μ)
- κ°€μ… μ„±κ³µν•λ©΄ "μ¶μ…μ¦"(JWT ν† ν°)μ„ 2μ¥ λ°κΈ‰ν•©λ‹λ‹¤:
  - **Access Token** (30λ¶„ μ ν¨) - μΌλ° μ¶μ…μ¦
  - **Refresh Token** (7μΌ μ ν¨) - μ¶μ…μ¦ μ¬λ°κΈ‰μ©

### λ΅κ·ΈμΈ ν”λ΅μ°

```
μ΄λ©”μΌ/λΉ„λ°€λ²νΈ μ…λ ¥ β†’ DBμ—μ„ μ‚¬μ©μ μ°ΎκΈ° β†’ λΉ„λ°€λ²νΈ μΌμΉ ν™•μΈ β†’ μƒ ν† ν° λ°κΈ‰
```

---

## π 2. λ§¤μ¥ κ΄€λ¦¬ (StoreService)

### ν•µμ‹¬ λ΅μ§: μ†μ κ¶ κ²€μ¦

λ¨λ“  λ§¤μ¥ κ΄€λ ¨ μ‘μ—…μ—μ„ "μ΄ λ§¤μ¥μ΄ μ •λ§ λ‚΄ λ§¤μ¥μΈκ°€?"λ¥Ό ν™•μΈν•©λ‹λ‹¤.

```java
// validateOwnership() λ©”μ„λ“
if (!store.getOwner().getId().equals(ownerId)) {
    throw new ForbiddenException("ν•΄λ‹Ή λ§¤μ¥μ— λ€ν• μ ‘κ·Ό κ¶ν•μ΄ μ—†μµλ‹λ‹¤");
}
```

**μ‰½κ² λ§ν•λ©΄:**

- A μ‚¬μ¥λ‹μ΄ B μ‚¬μ¥λ‹ λ§¤μ¥ μ •λ³΄λ¥Ό λ³Ό μ μ—†λ„λ΅ λ§‰μµλ‹λ‹¤
- λ΅κ·ΈμΈν• μ‚¬μ¥λ‹ IDμ™€ λ§¤μ¥ μ£ΌμΈ IDκ°€ κ°™μ€μ§€ ν•­μƒ λΉ„κµν•©λ‹λ‹¤

### λ§¤μ¥ μƒμ„± ν”λ΅μ°

```
λ΅κ·ΈμΈν• μ‚¬μ¥λ‹ ν™•μΈ β†’ λ§¤μ¥ μ •λ³΄ μ…λ ¥ β†’ μ‚¬μ¥λ‹κ³Ό λ§¤μ¥ μ—°κ²° β†’ DB μ €μ¥
```

---

## π‘¥ 3. μ§μ› κ΄€λ¦¬ (EmployeeService)

### ν•µμ‹¬ λ΅μ§: κ°μΈμ •λ³΄(PII) μ•”νΈν™”

μ§μ› μ „ν™”λ²νΈλ¥Ό μ•”νΈν™”ν•΄μ„ μ €μ¥ν•κ³ , μ΅°νν•  λ•λ§ λ³µνΈν™”ν•©λ‹λ‹¤.

```
μ €μ¥ μ‹: "010-1234-5678" β†’ μ•”νΈν™” β†’ "A3xK9mP..." (DBμ— μ €μ¥)
μ΅°ν μ‹: "A3xK9mP..." β†’ λ³µνΈν™” β†’ "010-1234-5678" (μ‘λ‹µμ— ν‘μ‹)
```

**μ‰½κ² λ§ν•λ©΄:**

- DBκ°€ ν•΄ν‚Ήλ‹Ήν•΄λ„ μ§μ› μ „ν™”λ²νΈλ” ν•΄λ… λ¶κ°€λ¥ν• μ•”νΈλ¬ΈμΌλ΅ μ €μ¥λμ–΄ μμ–΄μ„ μ•μ „ν•©λ‹λ‹¤
- μ΅°νν•  λ•λ§ μ•”νΈλ¥Ό ν’€μ–΄μ„ μ‚¬μ¥λ‹μ—κ² λ³΄μ—¬μ¤λ‹λ‹¤

### 2λ‹¨κ³„ μ†μ κ¶ κ²€μ¦

μ§μ› μ •λ³΄μ— μ ‘κ·Όν•λ ¤λ©΄ 2κ°€μ§€ κ΄€κ³„λ¥Ό λ¨λ‘ ν™•μΈν•©λ‹λ‹¤:

```
μ‚¬μ¥λ‹ β†’ λ§¤μ¥ β†’ μ§μ›

1λ‹¨κ³„: μ΄ λ§¤μ¥μ΄ λ‚΄(μ‚¬μ¥λ‹) λ§¤μ¥μΈκ°€?
2λ‹¨κ³„: μ΄ μ§μ›μ΄ κ·Έ λ§¤μ¥ μ†μ†μΈκ°€?
```

---

## π― 4. μ¨λ³΄λ”© μ™„λ£ (OnboardingService)

### ν•µμ‹¬ λ΅μ§: μ²« μ¤μΌ€μ¤„ μλ™ μƒμ„±

μ¨λ³΄λ”© μ™„λ£ μ‹ μ΄λ² μ£Ό(λλ” λ‹¤μ μ£Ό) μ¤μΌ€μ¤„μ„ μλ™μΌλ΅ λ§λ“¤μ–΄μ¤λ‹λ‹¤.

```java
// μ£Ό μ‹μ‘μΌ κ³„μ‚°
if (ν† μ”μΌ λλ” μΌμ”μΌ) {
    return λ‹¤μ μ£Ό μ›”μ”μΌ;
} else {
    return μ΄λ² μ£Ό μ›”μ”μΌ;
}
```

**μ‰½κ² λ§ν•λ©΄:**

- μμ”μΌμ— κ°€μ…ν•λ©΄ β†’ μ΄λ² μ£Ό μ›”μ”μΌ μ‹μ‘ μ¤μΌ€μ¤„ μƒμ„±
- ν† μ”μΌμ— κ°€μ…ν•λ©΄ β†’ λ‹¤μ μ£Ό μ›”μ”μΌ μ‹μ‘ μ¤μΌ€μ¤„ μƒμ„±
- μ¤μΌ€μ¤„μ€ DRAFT(μ΄μ•) μƒνƒλ΅ λ§λ“¤μ–΄μ Έμ„ λ°”λ΅ νΈμ§‘ν•  μ μμµλ‹λ‹¤

---

## π”’ 5. λ³΄μ• μ ν‹Έλ¦¬ν‹°

### AES-256-GCM μ•”νΈν™” (EncryptionUtil)

```
ν‰λ¬Έ β†’ [λλ¤ IV μƒμ„±] β†’ [AES-256-GCM μ•”νΈν™”] β†’ [Base64 μΈμ½”λ”©] β†’ μ•”νΈλ¬Έ
```

**μ‰½κ² λ§ν•λ©΄:**

- λ§¤λ² λ‹¤λ¥Έ λλ¤κ°’(IV)μ„ μ‚¬μ©ν•΄μ„ κ°™μ€ μ „ν™”λ²νΈλ„ λ§¤λ² λ‹¤λ¥Έ μ•”νΈλ¬Έμ΄ λ©λ‹λ‹¤
- AES-256μ€ ν„μ¬ κ°€μ¥ κ°•λ ¥ν• μ•”νΈν™” λ°©μ‹ μ¤‘ ν•λ‚μ…λ‹λ‹¤
- GCM λ¨λ“λ” λ°μ΄ν„°κ°€ μ„λ³€μ΅°λμ§€ μ•μ•λ”μ§€κΉμ§€ κ²€μ¦ν•©λ‹λ‹¤

### JWT ν† ν° (JwtTokenProvider)

```
ν† ν° λ‚΄μ©: { ownerId: 1, email: "abc@test.com", type: "access", λ§λ£μ‹κ°„: 30λ¶„ν›„ }
         β†“
      μ„λ…(SHA-256)
         β†“
ν† ν°: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**μ‰½κ² λ§ν•λ©΄:**

- ν† ν° μ•μ— "λ„κµ¬μΈμ§€(ownerId)"μ™€ "μ–Έμ κΉμ§€ μ ν¨ν•μ§€" μ •λ³΄κ°€ λ“¤μ–΄μμµλ‹λ‹¤
- ν† ν°μ΄ μ„μ΅°λλ©΄ μ„λ… κ²€μ¦μ—μ„ κ±Έλ¦½λ‹λ‹¤
- Access Tokenμ΄ λ§λ£λλ©΄ Refresh TokenμΌλ΅ μƒ Access Tokenμ„ λ°›μ„ μ μμµλ‹λ‹¤

---

## π“ μ „μ²΄ ν”λ΅μ° μ”μ•½

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     π― μ¨λ³΄λ”© 3λ‹¨κ³„ λ§λ²•μ‚¬                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                  β”‚
β”‚  1οΈβƒ£ νμ›κ°€μ…                                                     β”‚
β”‚     β””β”€ μ΄λ©”μΌ/λΉ„λ°€λ²νΈ μ…λ ¥ β†’ BCrypt μ•”νΈν™” β†’ JWT λ°κΈ‰            β”‚
β”‚                                                                  β”‚
β”‚  2οΈβƒ£ λ§¤μ¥ μ„¤μ •                                                    β”‚
β”‚     β””β”€ λ§¤μ¥λ…/μ—…μΆ…/μμ—…μ‹κ°„ μ…λ ¥ β†’ Ownerμ™€ μ—°κ²° β†’ DB μ €μ¥         β”‚
β”‚                                                                  β”‚
β”‚  3οΈβƒ£ μ§μ› λ“±λ΅                                                    β”‚
β”‚     β””β”€ μ΄λ¦„/μ‹κΈ‰/μ „ν™”λ²νΈ μ…λ ¥ β†’ μ „ν™”λ²νΈ AES μ•”νΈν™” β†’ DB μ €μ¥    β”‚
β”‚                                                                  β”‚
β”‚  β… μ¨λ³΄λ”© μ™„λ£                                                   β”‚
β”‚     β””β”€ DRAFT μ¤μΌ€μ¤„ μλ™ μƒμ„± β†’ λ€μ‹λ³΄λ“λ΅ μ΄λ™                   β”‚
β”‚                                                                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π’΅ ν•µμ‹¬ μ„¤κ³„ μ›μΉ™

| μ›μΉ™                | μ μ© λ‚΄μ©                                        |
| ------------------- | ------------------------------------------------ |
| **λ³΄μ•**      | λΉ„λ°€λ²νΈ BCrypt, μ „ν™”λ²νΈ AES-256-GCM μ•”νΈν™”     |
| **κ¶ν• λ¶„λ¦¬** | λ¨λ“  APIμ—μ„ μ†μ κ¶(Ownerβ†’Storeβ†’Employee) κ²€μ¦ |
| **μ‚¬μ©μ„±**    | μ¨λ³΄λ”© μ™„λ£ μ‹ μ²« μ¤μΌ€μ¤„ μλ™ μƒμ„±               |
| **ν† ν° κ΄€λ¦¬** | Access/Refresh λ¶„λ¦¬λ΅ λ³΄μ•κ³Ό νΈμμ„± κ· ν•         |
